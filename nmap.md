# NMAP

#### **|	База**

```bash
# as root - Syn scan | as user - TCP connect scan
nmap 192.168.1.35 # самое простое сканирование 1000 портов

sort -r -k3 /usr/share/nmap/nmap-services | grep tcp | head -n 100 # посмотреть наиболее популярные порты
```



#### **|	Параметры**

```bash
nmap -iL target.file # из файла
nmap -iR 3 -vv # 3 рандомных ip с большей вербальностью
# если нажать v в процессе сканирования - вербальность повысится
```



**|	HOST DISCOVERY**

Базовая проверка на активность без опций host-discovery

* ICMP edho request (ping)
* TCP SYN to 443
* TCP ACK to 80
* ICMP timestamp request
* ARP

```bash
nmap 192.168.1.1-5 -v # базовая проверка на активность и только потом проверка на открытые порты
```

1) Составление списка с помощью обратного DNS поиска

```bash
nmap -iR 300 -sL -vv # искатель приключений
```

2) Ping сканирование - базовая проверка, но без сканирования портов

```bash
nmap 192.168.1.1/24 -sn
```

3) Обратное - пропустить проверку на активность и выполнить сканирование

```bash
nmap 192.168.1.1/24 -Pn -v
```

4) Обнаружение по определенным портам или протоколам

```bash
nmap -iR 10 -PS22-25,80.113 -sn # PS/PA/PU/PY - Syn/Ack/Udp/SCTP
nmap -iR 10 -PE -sn # PE/PP/PM - ICMP echo/timestamp/netmask
nmap -iR 10 -PO1,2,4  -sn # IP проверка 1 = ICMP 2 = IGMP 3 = IPvIP
nmap -iR 10 -PR -sn # ARP проверка - самый быстрый
```

5) Доп приколы

* *-n/-R никогда не производить DNS разрешение / всегда проводить его*
* *--dns-server 192.168.1.4 проводить разрешение по определенным серверам (полезно в комбе с -sL)*
* *--system-dns - использовать системный резолв*
* *--traceroute - и так понятно*